
# Discovering Themes in Text with Topic Modeling (Latent dirichlet allocation)

## Description:

This method helps uncover hidden themes within a collection of text documents, making it a valuable tool for exploring unfamiliar domains. For example, a social scientist analyzing public discussions on social media or academic papers on a particular topic can use this method to identify recurring themes or topics.

The method assumes that each document contains a mixture of topics and that each topic comprises a distinct set of words. By processing a text file with one document per line, the method generates two key outputs:

- The probability of each topic appearing in each document.
- The most representative words for each topic, along with their probabilities.

This approach is built on [latent dirichlet allocation (LDA)](https://www.jmlr.org/papers/volume3/blei03a/blei03a.pdf?ref=http://githubhelp.com), using a specialized technique called collapsed Gibbs sampling [(LDA with collapsed gibbs sampling)](https://www.cs.cmu.edu/~wcohen/10-605/papers/fastlda.pdf). This enhances efficiency, producing a balanced topic distribution while allowing users control over the modelâ€™s internal workings.
It uses Markov chain monti carlo approach to initialize the model with a random state. The method provides vanila implementation (using only basic packages for loading data e.g., numpy, json and random number generation) of Topic modeling with maximum control to customize its behavior. It gives user control over internal decisions with transparent way. The method is implemented as a class to easily extend its behavior. 

## Keywords
topic modeling, latent dirichlet allocation, LDA

## Use case
A social scientist wants to examine the dynamics of political poll reviews to gain nuanced insights into voter interests.

## Structure
- [data/](data/)
- [data/input-data.txt](data/input-data.txt)

*generated by prepare-data.ipynb*
- [data/input-data/integer-encoded-data](data/input-data/integer-encoded-data)
- [data/input-data/dictionary.json](data/input-data/dictionary.json)
- [data/input-data/revdictionary.json](data/input-data/revdictionary.json)

*scripts*
- [LDA-collapsed-gibbs-sampling.ipynb](LDA-collapsed-gibbs-sampling.ipynb)
- [LICENSE.txt](LICENSE.txt)
- *requirements.txt not needed*
  
## Environment setup
As it is vanilla implementation of the latent dirichlet allocation technique with everything built from scratch. 
- Setup the environment using [requirements.txt](requirements.txt) through command `pip install -r requirements.txt`
- Put your data in [data/input-data.txt](data/input-data.txt)
- Execute the first notebook [prepare-data.ipynb](prepare-data.ipynb) to transform the data into integer encoding
- Execute the main notebook `[LDA-collapsed-gibbs-sampling.ipynb](LDA-collapsed-gibbs-sampling.ipynb) to get results 

## Sample input and output
- sample input data is given in [data/input-data.txt](data/input-data.txt)

| Headlines and Summaries |
|--------------------------|
| Wall St. Bears Claw Back Into the Black (Reuters) Reuters |
| Short-sellers, Wall Street's dwindling band of ultra-cynics, are seeing green again. |
| Carlyle Looks Toward Commercial Aerospace (Reuters) Reuters |
| Private investment firm Carlyle Group, which has a reputation for making well-timed and occasionally controversial plays in the defense industry, has quietly placed its bets on another part of the market. |
| Oil and Economy Cloud Stocks' Outlook (Reuters) Reuters |
| Soaring crude prices plus worries about the economy and the outlook for earnings are expected to hang over the stock market next week during the depth of the summer doldrums. |
| Iraq Halts Oil Exports from Main Southern Pipeline (Reuters) Reuters |
| Authorities have halted oil export flows from the main pipeline in southern Iraq after intelligence showed a rebel militia could strike infrastructure, an oil official said on Saturday. |
| Oil prices soar to all-time record, posing new menace to US economy (AFP) AFP |
| Tearaway world oil prices, toppling records and straining wallets, present a new economic menace barely three months before the US presidential elections. |
| Stocks End Up, But Near Year Lows (Reuters) Reuters |
| Stocks ended slightly higher on Friday but stayed near lows for the year as oil prices surged past barrel. |


- sample putput data is given in [data/output-data/document-topic-distribution.txt](data/output-data/document-topic-distribution.txt)
  
| Document   | Topic 0                 | Topic 1                 |
|------------|-------------------------|-------------------------|
| Document 0 | 0.6666666666666666      | 0.3333333333333333      |
| Document 1 | 0.5714285714285714      | 0.42857142857142855     |
| Document 2 | 0.8333333333333334      | 0.16666666666666666     |
| Document 3 | 0.8333333333333334      | 0.16666666666666666     |
| Document 4 | 0.8571428571428571      | 0.14285714285714285     |
| Document 5 | 0.125                   | 0.875                   |
| Document 6 | 0.125                   | 0.875                   |
| Document 7 | 0.25                    | 0.75                    |
| Document 8 | 0.25                    | 0.75                    |
| Document 9 | 0.6                     | 0.4                     |
| Document 10| 0.5714285714285714      | 0.42857142857142855     |
| Document 11| 0.7142857142857143      | 0.2857142857142857      |
| Document 12| 0.8571428571428571      | 0.14285714285714285     |
| Document 13| 0.14285714285714285     | 0.8571428571428571      |
| Document 14| 0.875                   | 0.125                   |
| Document 15| 0.14285714285714285     | 0.8571428571428571      |
| Document 16| 0.8571428571428571      | 0.14285714285714285     |
| Document 17| 0.7142857142857143      | 0.2857142857142857      |
| Document 18| 0.42857142857142855     | 0.5714285714285714      |
| Document 19| 0.42857142857142855     | 0.5714285714285714      |
 

and [data/output-data/topic-word-distribution.txt](data/output-data/topic-word-distribution.txt)

| Topic Name | Words and Probabilities                                                                                   |
|------------|----------------------------------------------------------------------------------------------------------|
| Topic 0    | enjoy: 0.0165, cooking: 0.0165, pasta: 0.0165, baking: 0.0165, dinner: 0.0015                             |
| Topic 1    | cooking: 0.0191, dinner: 0.0191, baking: 0.0191, enjoy: 0.0017, pasta: 0.0017                             |


## Contact details
M. Taimoor Khan (taimoor.khan@gesis.org)
